<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PNG to PDF Converter</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            padding: 20px;
            color: #fff;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2rem;
            color: #00d4ff;
        }

        .upload-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            border: 2px dashed #00d4ff;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 30px;
        }

        .upload-section:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: #00ff88;
        }

        .upload-section.dragover {
            background: rgba(0, 212, 255, 0.2);
            border-color: #00ff88;
        }

        .upload-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .upload-text {
            font-size: 1.1rem;
            color: #ccc;
        }

        #fileInput {
            display: none;
        }

        .preview-section {
            display: none;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .preview-section.active {
            display: block;
        }

        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .preview-title {
            font-size: 1.2rem;
            color: #00d4ff;
        }

        .file-info {
            font-size: 0.9rem;
            color: #aaa;
        }

        .preview-container {
            background: #fff;
            border-radius: 10px;
            padding: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 200px;
            max-height: 500px;
            overflow: auto;
        }

        #imagePreview {
            max-width: 100%;
            max-height: 480px;
            object-fit: contain;
        }

        .pdf-preview-section {
            display: none;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .pdf-preview-section.active {
            display: block;
        }

        .pdf-preview-container {
            background: #fff;
            border-radius: 10px;
            width: 100%;
            height: 500px;
        }

        #pdfPreview {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 10px;
        }

        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 30px;
            font-size: 1rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .btn-convert {
            background: linear-gradient(135deg, #00d4ff, #0099cc);
            color: #fff;
        }

        .btn-convert:hover {
            background: linear-gradient(135deg, #00e5ff, #00aadd);
            transform: translateY(-2px);
        }

        .btn-download {
            background: linear-gradient(135deg, #00ff88, #00cc6a);
            color: #1a1a2e;
        }

        .btn-download:hover {
            background: linear-gradient(135deg, #00ff99, #00dd7b);
            transform: translateY(-2px);
        }

        .btn-reset {
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
        }

        .btn-reset:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .status {
            text-align: center;
            margin-top: 20px;
            font-size: 0.95rem;
            color: #00ff88;
        }

        .status.error {
            color: #ff6b6b;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>PNG to PDF Converter</h1>

        <div class="upload-section" id="uploadSection">
            <div class="upload-icon">üìÅ</div>
            <div class="upload-text">Click or drag & drop a PNG image here</div>
            <input type="file" id="fileInput" accept="image/png">
        </div>

        <div class="preview-section" id="previewSection">
            <div class="preview-header">
                <span class="preview-title">Image Preview</span>
                <span class="file-info" id="fileInfo"></span>
            </div>
            <div class="preview-container">
                <img id="imagePreview" alt="Preview">
            </div>
        </div>

        <div class="pdf-preview-section" id="pdfPreviewSection">
            <div class="preview-header">
                <span class="preview-title">PDF Preview</span>
            </div>
            <div class="pdf-preview-container">
                <iframe id="pdfPreview"></iframe>
            </div>
        </div>

        <div class="buttons">
            <button class="btn btn-convert" id="convertBtn" disabled>Convert to PDF</button>
            <button class="btn btn-download" id="downloadBtn" disabled>Download PDF</button>
            <button class="btn btn-reset" id="resetBtn">Reset</button>
        </div>

        <div class="status" id="status"></div>
    </div>

    <script>
        const { jsPDF } = window.jspdf;

        const uploadSection = document.getElementById('uploadSection');
        const fileInput = document.getElementById('fileInput');
        const previewSection = document.getElementById('previewSection');
        const imagePreview = document.getElementById('imagePreview');
        const fileInfo = document.getElementById('fileInfo');
        const pdfPreviewSection = document.getElementById('pdfPreviewSection');
        const pdfPreview = document.getElementById('pdfPreview');
        const convertBtn = document.getElementById('convertBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const resetBtn = document.getElementById('resetBtn');
        const status = document.getElementById('status');

        let currentImage = null;
        let pdfBlob = null;
        let pdfBlobUrl = null;

        // Upload section click
        uploadSection.addEventListener('click', () => fileInput.click());

        // Drag and drop
        uploadSection.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadSection.classList.add('dragover');
        });

        uploadSection.addEventListener('dragleave', () => {
            uploadSection.classList.remove('dragover');
        });

        uploadSection.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadSection.classList.remove('dragover');
            const file = e.dataTransfer.files[0];
            if (file && file.type === 'image/png') {
                handleFile(file);
            } else {
                showStatus('Please upload a PNG file only.', true);
            }
        });

        // File input change
        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                handleFile(file);
            }
        });

        function handleFile(file) {
            if (file.type !== 'image/png') {
                showStatus('Please upload a PNG file only.', true);
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                currentImage = new Image();
                currentImage.onload = () => {
                    imagePreview.src = currentImage.src;
                    fileInfo.textContent = `${file.name} (${currentImage.width} x ${currentImage.height}px)`;
                    previewSection.classList.add('active');
                    pdfPreviewSection.classList.remove('active');
                    convertBtn.disabled = false;
                    downloadBtn.disabled = true;
                    showStatus('Image loaded. Click "Convert to PDF" to proceed.');
                };
                currentImage.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        // Convert to PDF
        convertBtn.addEventListener('click', () => {
            if (!currentImage) return;

            showStatus('Converting to PDF...');

            // Get image dimensions
            const imgWidth = currentImage.width;
            const imgHeight = currentImage.height;

            // Create PDF with custom page size matching the image aspect ratio
            // We'll fit the image to a single page while maintaining aspect ratio
            // Using points (1 inch = 72 points), standard A4 is 595 x 842 points

            // Calculate the best page size to fit the image without distortion
            // Max dimensions in mm for reasonable page size
            const maxWidth = 297; // A3 width in mm
            const maxHeight = 420; // A3 height in mm

            // Convert pixels to mm (assuming 96 DPI screen)
            const pxToMm = 25.4 / 96;
            let pdfWidth = imgWidth * pxToMm;
            let pdfHeight = imgHeight * pxToMm;

            // Scale down if too large
            if (pdfWidth > maxWidth) {
                const scale = maxWidth / pdfWidth;
                pdfWidth = maxWidth;
                pdfHeight = pdfHeight * scale;
            }
            if (pdfHeight > maxHeight) {
                const scale = maxHeight / pdfHeight;
                pdfHeight = maxHeight;
                pdfWidth = pdfWidth * scale;
            }

            // Minimum size
            pdfWidth = Math.max(pdfWidth, 50);
            pdfHeight = Math.max(pdfHeight, 50);

            // Determine orientation
            const orientation = pdfWidth > pdfHeight ? 'landscape' : 'portrait';

            // Create PDF with exact page size to fit image
            const pdf = new jsPDF({
                orientation: orientation,
                unit: 'mm',
                format: [pdfWidth, pdfHeight]
            });

            // Add image to fill the entire page
            pdf.addImage(currentImage.src, 'PNG', 0, 0, pdfWidth, pdfHeight);

            // Generate blob for preview and download
            pdfBlob = pdf.output('blob');

            // Clean up previous blob URL
            if (pdfBlobUrl) {
                URL.revokeObjectURL(pdfBlobUrl);
            }
            pdfBlobUrl = URL.createObjectURL(pdfBlob);

            // Show PDF preview
            pdfPreview.src = pdfBlobUrl;
            pdfPreviewSection.classList.add('active');
            downloadBtn.disabled = false;

            showStatus('PDF created! Preview above. Click "Download PDF" to save.');
        });

        // Download PDF
        downloadBtn.addEventListener('click', () => {
            if (!pdfBlobUrl) return;

            const link = document.createElement('a');
            link.href = pdfBlobUrl;
            link.download = 'converted-image.pdf';
            link.click();

            showStatus('PDF downloaded!');
        });

        // Reset
        resetBtn.addEventListener('click', () => {
            currentImage = null;
            pdfBlob = null;
            if (pdfBlobUrl) {
                URL.revokeObjectURL(pdfBlobUrl);
                pdfBlobUrl = null;
            }

            fileInput.value = '';
            imagePreview.src = '';
            pdfPreview.src = '';
            previewSection.classList.remove('active');
            pdfPreviewSection.classList.remove('active');
            convertBtn.disabled = true;
            downloadBtn.disabled = true;
            status.textContent = '';
        });

        function showStatus(message, isError = false) {
            status.textContent = message;
            status.className = 'status' + (isError ? ' error' : '');
        }
    </script>
</body>
</html>
